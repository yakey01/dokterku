# Public Directory Guidelines

## Overview
Publicly accessible files. Only put files here that should be directly accessible via URL.

## Directory Structure
- `/build` - Compiled assets from Vite (auto-generated)
- `/images` - Static images
- `/fonts` - Custom fonts
- `/vendor` - Third-party assets
- `/storage` - Symlink to storage/app/public

## Security Rules

### NEVER Store
- ❌ Configuration files
- ❌ .env files
- ❌ Database files
- ❌ Private keys or certificates
- ❌ Source code files
- ❌ Uncompiled assets
- ❌ Sensitive documents

### Safe to Store
- ✅ Compiled CSS/JS (in /build)
- ✅ Public images and logos
- ✅ Favicon and app icons
- ✅ robots.txt
- ✅ Public downloadable files

## Asset Management

### Vite Build Output
```
/build/
  ├── assets/
  │   ├── app-[hash].js
  │   ├── app-[hash].css
  │   └── images/
  └── manifest.json
```

### DO NOT manually edit files in /build
- These are auto-generated by Vite
- Source files are in /resources
- Run `npm run build` to compile

## Image Guidelines

### Organization
```
/images/
  ├── logo/
  │   ├── logo.svg
  │   ├── logo-dark.svg
  │   └── favicon.ico
  ├── avatars/
  │   └── default.png
  └── icons/
      └── [icon-files]
```

### Optimization
- Compress images before uploading
- Use WebP format when possible
- Implement responsive images
- Lazy load non-critical images

## Storage Symlink

### Setup
```bash
php artisan storage:link
```

This creates: `public/storage → storage/app/public`

### Usage
- Upload user files to `storage/app/public`
- Access via `/storage/filename`
- Never store in `/public` directly

## Security Headers

### .htaccess (Apache)
```apache
# Prevent directory listing
Options -Indexes

# Prevent access to hidden files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Security headers
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "SAMEORIGIN"
Header set X-XSS-Protection "1; mode=block"
```

### nginx Configuration
```nginx
# Prevent access to hidden files
location ~ /\. {
    deny all;
}

# Security headers
add_header X-Content-Type-Options "nosniff";
add_header X-Frame-Options "SAMEORIGIN";
add_header X-XSS-Protection "1; mode=block";
```

## Performance Tips

### Caching
- Set proper cache headers for static assets
- Use versioned filenames for cache busting
- Implement CDN for static assets
- Enable gzip compression

### File Size Limits
- Images: Max 2MB per file
- Documents: Max 10MB per file
- Total /public size: Monitor regularly

## Common Issues

### 404 on Assets
- Check if `npm run build` was executed
- Verify manifest.json exists
- Clear browser cache
- Check file permissions

### Storage Link Issues
- Re-create link: `php artisan storage:link`
- Check symlink permissions
- Verify storage path exists

### CORS Issues
- Configure in `cors.php` config
- Add headers in .htaccess if needed
- Check server configuration

## Deployment Checklist

Before deploying:
1. ✅ Run `npm run build` for production assets
2. ✅ Optimize images
3. ✅ Remove development files
4. ✅ Set proper file permissions (755 for directories, 644 for files)
5. ✅ Configure security headers
6. ✅ Enable caching rules
7. ✅ Test all asset paths

## File Permissions
```bash
# Directories
find public -type d -exec chmod 755 {} \;

# Files
find public -type f -exec chmod 644 {} \;

# Storage directory (if symlinked)
chmod -R 775 storage/app/public
```