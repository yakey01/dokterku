var $e=Object.defineProperty;var Ae=(h,a,t)=>a in h?$e(h,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[a]=t;var U=(h,a,t)=>Ae(h,typeof a!="symbol"?a+"":a,t);import{c as L,C as ge}from"./chevron-right-DjLsWaQd.js";import{r as j,j as e}from"./index-ClR2o9Bl.js";import{L as pe,T as Ce}from"./target-rAQgpO39.js";import{C as Pe,T as Ie}from"./trending-up-DmJG-YAw.js";import{S as De,Z as fe,a as Q,H as Me}from"./zap-B4KSnBV3.js";import{A as xe}from"./activity-BpHUwRg8.js";import{g as _}from"./UnifiedAuth-Bo5tzQqB.js";const Re=L("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),Je=L("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),tt=L("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Le=L("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Fe=L("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Oe={BASE_URL:"/build/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_NAME:"Dokter Ku Klinik",VITE_DEV_SERVER_URL:"http://127.0.0.1:5173",VITE_PUSHER_APP_CLUSTER:"mt1",VITE_PUSHER_APP_KEY:"",VITE_USER_NODE_ENV:"production"};var Ue={};class qe{constructor(){U(this,"config");const a=this.isDevelopmentMode();this.config={enabled:a,level:"debug",prefix:"🔧"}}isDevelopmentMode(){try{const a=[];try{typeof import.meta<"u"}catch{}try{typeof process<"u"}catch{}if(typeof window<"u"&&window.location){const t=window.location.hostname,n=window.location.port;(t==="localhost"||t==="127.0.0.1"||t.includes("local")||n!==""||t.includes("dev")||t.includes("staging")||t.includes("test"))&&a.push(!0)}try{typeof localStorage<"u"&&localStorage.getItem("debug_mode")==="true"&&a.push(!0)}catch{}try{typeof window<"u"&&new URLSearchParams(window.location.search).has("debug")&&a.push(!0)}catch{}try{if(typeof document<"u"){const t=document.querySelector('meta[name="app-debug"]');t&&t.getAttribute("content")==="true"&&a.push(!0)}}catch{}return a.length>0}catch{return!1}}log(a,t){this.config.enabled&&(t!==void 0?console.log(`${this.config.prefix} ${a}`,t):console.log(`${this.config.prefix} ${a}`))}info(a,t){this.config.enabled&&(t!==void 0?console.info(`ℹ️ ${a}`,t):console.info(`ℹ️ ${a}`))}warn(a,t){this.config.enabled&&(t!==void 0?console.warn(`⚠️ ${a}`,t):console.warn(`⚠️ ${a}`))}error(a,t){this.config.enabled&&(t!==void 0?console.error(`❌ ${a}`,t):console.error(`❌ ${a}`))}api(a,t){this.config.enabled&&(t?console.log(`🌐 API Call: ${a}`,t):console.log(`🌐 API Call: ${a}`))}performance(a,t){this.config.enabled&&console.log(t!==void 0?`⚡ Performance: ${a} took ${t}ms`:`⚡ Performance: ${a}`)}state(a,t){this.config.enabled&&console.log(`📊 State Update [${a}]:`,t)}transform(a,t){this.config.enabled&&console.log(`🔄 Transform [${a}]:`,t)}group(a,t){if(!this.config.enabled){t();return}console.group(`📁 ${a}`),t(),console.groupEnd()}table(a,t){this.config.enabled&&(console.log(`📋 ${a}:`),console.table(t))}toggle(){this.config.enabled=!this.config.enabled,localStorage.setItem("debug_mode",this.config.enabled.toString()),console.log(`🔧 Debug mode ${this.config.enabled?"ENABLED":"DISABLED"}`)}isEnabled(){return this.config.enabled}prodError(a,t){t!==void 0?console.error(`🚨 CRITICAL: ${a}`,t):console.error(`🚨 CRITICAL: ${a}`)}prodPerformance(a,t){t>1e3&&console.warn(`⚡ SLOW: ${a} took ${t}ms`)}getEnvInfo(){return{isDev:this.config.enabled,hostname:window.location.hostname,port:window.location.port,href:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString()}}}const u=new qe,l=u;u.log.bind(u);u.info.bind(u);u.warn.bind(u);u.error.bind(u);const ze=u.api.bind(u);u.performance.bind(u);const He=u.state.bind(u),ee=u.transform.bind(u);u.group.bind(u);u.table.bind(u);const Ge=u.prodError.bind(u);u.prodPerformance.bind(u);function at({userData:h,onNavigate:a}){const[t,n]=j.useState(!0),[c,o]=j.useState(null),[x,F]=j.useState([]),[O,q]=j.useState(12),[R,z]=j.useState(8),[H,G]=j.useState(4),[V,W]=j.useState(96),[N,be]=j.useState(!1),[ve,ye]=j.useState("portrait"),[se,je]=j.useState(0),[v,K]=j.useState(1),X=6,re=async(s=!1)=>{var d,r,p,y,S,g,E,C,P,i,k;l.log(`JadwalJaga: ${s?"Refreshing":"Starting"} API fetch at ${new Date().toLocaleTimeString()}`);try{s||n(!0),o(null);const w=((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content"))||"";l.log("Making API call to /api/v2/dashboards/dokter/jadwal-jaga with web session auth");const b=s?`?refresh=${Date.now()}`:"",f=await fetch(`/api/v2/dashboards/dokter/jadwal-jaga${b}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":w,"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(ze("jadwal-jaga",{status:f.status,ok:f.ok}),!f.ok)throw f.status===401?new Error("Authentication required. Please login again."):f.status===404?new Error("API endpoint not found. Please check configuration."):new Error(`API Error: ${f.status} - ${f.statusText}`);const m=await f.json();if(l.log("API Data received:",{hasData:!!m.data,calendarEventsCount:((p=(r=m.data)==null?void 0:r.calendar_events)==null?void 0:p.length)||0,weeklyScheduleCount:((S=(y=m.data)==null?void 0:y.weekly_schedule)==null?void 0:S.length)||0,hasScheduleStats:!!((g=m.data)!=null&&g.schedule_stats),success:m.success,message:m.message}),!m.success)throw new Error(m.message||"API returned unsuccessful response");if((E=m.data)!=null&&E.schedule_stats){const $=m.data.schedule_stats;l.log("Schedule stats from API:",$),z($.completed||0),G($.upcoming||0),W($.total_hours||0),q($.total_shifts||0)}const T=((C=m.data)==null?void 0:C.weekly_schedule)||[],J=((P=m.data)==null?void 0:P.calendar_events)||[],Z=[...T,...J],he=new Set,Y=Z.filter($=>{const A=$.id;return he.has(A)?!1:(he.add(A),!0)});l.log("Schedule sources:",{weeklySchedulesCount:T.length,calendarEventsCount:J.length,totalCombined:Z.length,afterDeduplication:Y.length,duplicatesRemoved:Z.length-Y.length});const I=oe(Y);ee("missions",{count:I.length}),I.length===0?(l.warn("No API schedules found - checking if this is expected"),((k=(i=m.data)==null?void 0:i.schedule_stats)==null?void 0:k.total_shifts)>0?(l.log("User has schedules but none returned - this might be a data issue"),o("Schedules exist but cannot be displayed. Please contact administrator.")):(l.log("No schedules found for user - this is expected if user has no assignments"),o("No schedules assigned. Please contact administrator for duty assignments.")),F([])):(l.log(`Using real API schedule data - ${I.length} schedules loaded`),l.log("Schedule cards that will be displayed:",I.map(A=>{var me;return{id:A.id,title:A.title,shift:(me=A.shift_template)==null?void 0:me.nama_shift,time:A.time,date:A.date}})),JSON.stringify(I)!==JSON.stringify(x)&&He("JadwalJaga",`Schedule data has changed, updating UI with ${I.length} cards`),F(I)),l.log("JadwalJaga: Data loaded successfully")}catch(w){Ge("Failed to fetch jadwal jaga:",w),l.error("Failed to fetch jadwal jaga:",w);const b=w instanceof Error?w.message:"Unknown error occurred";o(`Failed to load schedule data: ${b}`),F([]),l.log("Showing error state instead of fallback data")}finally{n(!1),l.log("JadwalJaga: Loading complete"),je(Date.now())}};j.useEffect(()=>{re()},[]),j.useEffect(()=>{const s=setInterval(()=>{l.log("Auto-refresh: Fetching latest schedule data..."),re(!0).catch(d=>{l.error("Auto-refresh failed:",d)})},6e4);return()=>clearInterval(s)},[]);const ne=async()=>{var s,d,r,p;l.log("Force refresh triggered"),n(!0),o(null);try{const y=(h==null?void 0:h.token)||localStorage.getItem("auth_token")||((s=document.querySelector('meta[name="api-token"]'))==null?void 0:s.getAttribute("content"))||"",S=await fetch(`/api/v2/dashboards/dokter/jadwal-jaga?refresh=${Date.now()}`,{headers:{Authorization:`Bearer ${y}`,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!S.ok)throw new Error(`API Error: ${S.status}`);const g=await S.json();l.log("Force refresh data received:",g);const E=((d=g.data)==null?void 0:d.weekly_schedule)||[],C=((r=g.data)==null?void 0:r.calendar_events)||[],P=[...E,...C],i=new Set,k=P.filter(b=>{const f=b.id;return i.has(f)?!1:(i.add(f),!0)}),w=oe(k);if(F(w),(p=g.data)!=null&&p.schedule_stats){const b=g.data.schedule_stats;z(b.completed||0),G(b.upcoming||0),W(b.total_hours||0),q(b.total_shifts||0)}l.log("Force refresh completed successfully")}catch(y){l.error("Force refresh failed:",y),o("Gagal memperbarui jadwal")}finally{n(!1)}},oe=s=>{ee("starting",s);const d=s.map((r,p)=>{var E,C,P;l.log(`Processing schedule ${p}:`,r),l.log("Schedule details:",{hasTime:!!r.time,timeValue:r.time||"no time field",start:r.start,end:r.end,shift_info:r.shift_info,shift_template:r.shift_template});const y=r.start&&r.title,S=r.tanggal_jaga||r.shift_template;l.log("Schedule type:",{isCalendarEvent:y,isWeeklySchedule:S,hasShiftTemplate:!!r.shift_template,hasShiftInfo:!!r.shift_info,shiftData:r.shift_template||r.shift_info||null});let g;if(y){const i=r.shift_info||{},k=m=>{if(!m)return m;if(m.includes("T")){const T=m.split("T")[1];if(T)return T.split(":").slice(0,2).join(":")}return m.split(":").slice(0,2).join(":")},w=k(i.jam_masuk)||"08:00",b=k(i.jam_pulang)||"16:00",f=`${w} - ${b}`;l.log("Time formatting:",{originalJamMasuk:i.jam_masuk,originalJamPulang:i.jam_pulang,formattedJamMasuk:w,formattedJamPulang:b,finalTime:f}),g={id:r.id||p+1,title:r.title||i.nama_shift||"Dokter Jaga",subtitle:ie(i.nama_shift),date:new Date(r.start).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),full_date:r.start,day_name:new Date(r.start).toLocaleDateString("id-ID",{weekday:"long"}),time:f,location:i.unit_kerja||r.description||"Unit Kerja",type:le(i.nama_shift),difficulty:"easy",status:"available",status_jaga:ce(i.status||"aktif"),description:r.description||`${i.nama_shift||"Shift"} duty assignment`,peran:i.peran||"Dokter Jaga",employee_name:i.employee_name||(h==null?void 0:h.name)||"dr. Medical Officer",shift_template:{id:i.id||p+1,nama_shift:i.nama_shift||"Pagi",jam_masuk:k(i.jam_masuk)||"08:00",jam_pulang:k(i.jam_pulang)||"16:00"}}}else if(S){const i=r.shift_template||{},k=r.tanggal_jaga||r.date,w=T=>{if(!T)return T;if(T.includes("T")){const J=T.split("T")[1];if(J)return J.split(":").slice(0,2).join(":")}return T.split(":").slice(0,2).join(":")},b=w(i.jam_masuk)||"08:00",f=w(i.jam_pulang)||"16:00",m=`${b} - ${f}`;l.log("Weekly schedule time formatting:",{originalJamMasuk:i.jam_masuk,originalJamPulang:i.jam_pulang,formattedJamMasuk:b,formattedJamPulang:f,finalTime:m}),g={id:r.id||p+1,title:i.nama_shift||"Dokter Jaga",subtitle:ie(i.nama_shift),date:new Date(k).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),full_date:k,day_name:new Date(k).toLocaleDateString("id-ID",{weekday:"long"}),time:m,location:r.unit_kerja||"Unit Kerja",type:le(i.nama_shift),difficulty:"easy",status:"available",status_jaga:ce(r.status_jaga||"aktif"),description:r.keterangan||`${i.nama_shift||"Shift"} duty assignment`,peran:r.peran||"Dokter Jaga",employee_name:r.employee_name||(h==null?void 0:h.name)||"dr. Medical Officer",shift_template:{id:i.id||p+1,nama_shift:i.nama_shift||"Pagi",jam_masuk:w(i.jam_masuk)||"08:00",jam_pulang:w(i.jam_pulang)||"16:00"}}}else l.warn("Unknown schedule format, using fallback:",r),g={id:r.id||p+1,title:"Dokter Jaga",subtitle:"General Medical Duty",date:new Date().toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),full_date:new Date().toISOString(),day_name:new Date().toLocaleDateString("id-ID",{weekday:"long"}),time:"08:00 - 16:00",location:"Unit Kerja",type:"regular",difficulty:"easy",status:"available",status_jaga:"Terjadwal",description:"Medical duty assignment",peran:"Dokter Jaga",employee_name:(h==null?void 0:h.name)||"dr. Medical Officer",shift_template:{id:p+1,nama_shift:"Pagi",jam_masuk:"08:00",jam_pulang:"16:00"}};return l.log("Created mission:",g),l.log("Mission time details:",{id:g.id,shift:(E=g.shift_template)==null?void 0:E.nama_shift,displayTime:g.time,jam_masuk:(C=g.shift_template)==null?void 0:C.jam_masuk,jam_pulang:(P=g.shift_template)==null?void 0:P.jam_pulang,originalScheduleTime:r.time||"no time in schedule"}),g}).filter(r=>r!==null);return ee("final missions",d),d},ie=s=>{switch(s==null?void 0:s.toLowerCase()){case"malam":return"Emergency Critical Care";case"pagi":return"Morning Patient Rounds";case"siang":return"Afternoon Clinical Care";case"sore":return"Evening Medical Service";default:return"General Outpatient Care"}},le=s=>{switch(s==null?void 0:s.toLowerCase()){case"malam":return"urgent";case"emergency":return"urgent";case"training":return"training";case"workshop":return"training";default:return"regular"}},ce=s=>({selesai:"Completed",completed:"Completed",aktif:"Aktif",active:"Aktif",berlangsung:"Aktif",upcoming:"Terjadwal",terjadwal:"Terjadwal",cuti:"Cuti",izin:"Izin",oncall:"OnCall"})[s==null?void 0:s.toLowerCase()]||"Terjadwal";j.useEffect(()=>{const s=()=>{const d=window.innerWidth,r=window.innerHeight;be(d>=768),ye(d>r?"landscape":"portrait")};return s(),window.addEventListener("resize",s),window.addEventListener("orientationchange",s),()=>{window.removeEventListener("resize",s),window.removeEventListener("orientationchange",s)}},[]),j.useEffect(()=>{if(x.length>0&&R===8&&H===4&&V===96){l.log("Calculating stats from missions as fallback"),q(x.length),z(x.filter(d=>d.status_jaga==="Completed").length),G(x.filter(d=>d.status_jaga==="Terjadwal").length);const s=x.reduce((d,r)=>{if(r.shift_template){const p=r.shift_template.jam_masuk.split(":"),y=r.shift_template.jam_pulang.split(":"),S=parseInt(p[0])*60+parseInt(p[1]);let E=parseInt(y[0])*60+parseInt(y[1])-S;return E<0&&(E+=1440),d+E/60}return d},0);W(Math.round(s))}else x.length>0&&l.log("Using API-provided schedule stats, skipping mission-based calculation")},[x,R,H,V]);const M=Math.ceil(x.length/X),B=(v-1)*X,de=B+X,ue=x.slice(B,de),ke=s=>{K(s)},_e=()=>{v>1&&K(v-1)},Ne=()=>{v<M&&K(v+1)},Se=s=>s.difficulty==="legendary"?Q:s.type==="urgent"?xe:s.type==="special"?fe:s.type==="training"?Ce:s.subtitle.toLowerCase().includes("malam")?Q:s.subtitle.toLowerCase().includes("pagi")?Me:Fe,Ee=s=>{switch(s.status_jaga){case"Aktif":return"from-green-600 to-emerald-600";case"OnCall":return"from-red-600 to-orange-600";case"Cuti":return"from-purple-600 to-pink-600";case"Izin":return"from-blue-600 to-cyan-600";default:return"from-indigo-600 to-blue-600"}},Te=s=>{switch(s.status_jaga){case"Aktif":return"from-green-500/20 to-emerald-500/20";case"OnCall":return"from-red-500/20 to-orange-500/20";case"Cuti":return"from-purple-500/20 to-pink-500/20";case"Izin":return"from-blue-500/20 to-cyan-500/20";default:return"from-indigo-500/20 to-blue-500/20"}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white",children:e.jsxs("div",{className:"w-full min-h-screen relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 bg-blue-500 bg-opacity-5 rounded-full blur-3xl animate-pulse",style:{left:"10%",width:"30vw",maxWidth:"400px",height:"30vw",maxHeight:"400px"}}),e.jsx("div",{className:"absolute top-60 bg-purple-500 bg-opacity-5 rounded-full blur-2xl animate-bounce",style:{right:"5%",width:"25vw",maxWidth:"350px",height:"25vw",maxHeight:"350px"}}),e.jsx("div",{className:"absolute bottom-80 bg-pink-500 bg-opacity-5 rounded-full blur-3xl animate-pulse",style:{left:"15%",width:"28vw",maxWidth:"380px",height:"28vw",maxHeight:"380px"}})]}),e.jsxs("div",{className:"relative z-10 px-4 sm:px-6 md:px-8 lg:px-12 xl:px-16 2xl:px-20 pt-8 pb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx("h1",{className:`font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent
                ${N?"text-3xl md:text-4xl lg:text-5xl":"text-2xl sm:text-3xl"}
              `,children:"Medical Mission Central"}),e.jsx("button",{onClick:ne,disabled:t,className:"ml-4 p-2 bg-white/10 hover:bg-white/20 rounded-xl border border-white/20 transition-all duration-300 disabled:opacity-50",title:"Force refresh schedules (immediate update)",children:e.jsx(pe,{className:`w-5 h-5 text-cyan-400 ${t?"animate-spin":""}`})})]}),e.jsx("p",{className:`text-purple-200 ${N?"text-lg md:text-xl":"text-base"}`,children:"Elite Doctor Duty Assignments"}),c&&e.jsx("div",{className:"flex items-center justify-center mt-4",children:e.jsxs("div",{className:"text-xs bg-red-600/20 hover:bg-red-600/40 border border-red-400/30 text-red-300 px-4 py-2 rounded-xl backdrop-blur-sm",children:["⚠️ ",c]})}),se>0&&e.jsxs("div",{className:"text-xs text-gray-400 mt-2",children:["Last updated: ",new Date(se).toLocaleTimeString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-2xl p-4 border border-purple-400/20 hover:border-purple-400/40 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-purple-400"}),e.jsx(Re,{className:"w-4 h-4 text-purple-300/50"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:O}),e.jsx("div",{className:"text-xs text-purple-300/80",children:"Total Missions"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-2xl p-4 border border-green-400/20 hover:border-green-400/40 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Le,{className:"w-5 h-5 text-green-400"}),e.jsx(De,{className:"w-4 h-4 text-green-300/50"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-400",children:R}),e.jsx("div",{className:"text-xs text-green-300/80",children:"Completed"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-2xl p-4 border border-orange-400/20 hover:border-orange-400/40 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(fe,{className:"w-5 h-5 text-orange-400"}),e.jsx(Je,{className:"w-4 h-4 text-orange-300/50"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:H}),e.jsx("div",{className:"text-xs text-orange-300/80",children:"Upcoming"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-2xl p-4 border border-blue-400/20 hover:border-blue-400/40 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-400"}),e.jsx(Ie,{className:"w-4 h-4 text-blue-300/50"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:V}),e.jsx("div",{className:"text-xs text-blue-300/80",children:"Total Hours"})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-2xl p-4 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white font-semibold",children:"Mission Progress"}),e.jsxs("span",{className:"text-cyan-400 font-bold",children:[R," / ",O]})]}),e.jsx("div",{className:"bg-gray-800/50 rounded-full h-3 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 rounded-full transition-all duration-1000 ease-out",style:{width:`${O>0?R/O*100:0}%`},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})})]})]}),t&&e.jsx("div",{className:"relative z-10 px-4 sm:px-6 md:px-8 lg:px-12 xl:px-16 2xl:px-20 py-12",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-2xl p-8 border border-purple-400/20",children:[e.jsx(pe,{className:"w-8 h-8 animate-spin text-purple-400 mx-auto mb-3"}),e.jsx("span",{className:"text-purple-300 text-center block",children:"Loading Mission Database..."})]})})}),!t&&e.jsxs("div",{className:"relative z-10 px-4 sm:px-6 md:px-8 lg:px-12 xl:px-16 2xl:px-20 pb-32",children:[e.jsx("div",{className:`
              grid gap-6 md:gap-8
              ${N&&ve==="landscape"?"lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-3":"sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3"}
            `,children:ue.map(s=>{var y;const d=Se(s),r=Ee(s),p=Te(s);return e.jsx("div",{className:"relative group cursor-default transform transition-all duration-300 hover:scale-[1.01]",children:e.jsxs("div",{className:`
                      relative bg-white/8 backdrop-blur-xl rounded-2xl overflow-hidden
                      border border-white/15 group-hover:border-white/25
                      transition-all duration-300 group-hover:bg-white/10
                      ${N?"p-4":"p-3"}
                    `,children:[e.jsx("div",{className:`
                        absolute inset-0 bg-gradient-to-br ${p} opacity-0 
                        group-hover:opacity-30 transition-opacity duration-400
                      `}),e.jsxs("div",{className:"relative z-10 mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[e.jsx("div",{className:`
                            bg-gradient-to-br ${r} rounded-xl flex items-center justify-center
                            shadow-sm transition-all duration-300
                            ${N?"w-10 h-10 p-2.5":"w-8 h-8 p-2"}
                          `,children:e.jsx(d,{className:`text-white ${N?"w-5 h-5":"w-4 h-4"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold text-white mb-1 ${N?"text-base":"text-sm"}`,children:((y=s.shift_template)==null?void 0:y.nama_shift)||s.title||"Dokter Jaga"}),e.jsx("p",{className:`text-gray-300 font-medium ${N?"text-sm":"text-xs"}`,children:s.subtitle||"Shift Jaga"})]})]}),e.jsx("div",{className:`
                          bg-white/8 backdrop-blur-md rounded-xl border border-white/10
                          ${N?"p-3":"p-2.5"}
                        `,children:e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("div",{className:`text-gray-300 font-medium ${N?"text-sm":"text-xs"}`,children:new Date(s.full_date).toLocaleDateString("en-US",{month:"short",day:"2-digit"})}),e.jsx("div",{className:"text-gray-400 text-xs",children:s.peran}),e.jsx("div",{className:`text-white font-semibold ${N?"text-base":"text-sm"}`,children:s.time})]})})]})]})},s.id)})}),ue.length===0&&!t&&e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-2xl p-8 border border-white/10 max-w-md mx-auto",children:[e.jsx(Q,{className:"h-16 w-16 mx-auto mb-4 text-purple-400"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:c?"Error Loading Schedules":"No Schedules Available"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:c||"No medical schedules available for this page"}),c&&e.jsx("button",{onClick:ne,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors duration-200",children:"Try Again"})]})}),M>1&&e.jsxs("div",{className:"flex flex-col items-center mt-10 space-y-4",children:[e.jsx("div",{className:"bg-white/5 backdrop-blur-xl rounded-2xl p-4 border border-white/10 shadow-2xl shadow-purple-500/10",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:_e,disabled:v===1,className:`
                        group relative flex items-center justify-center w-12 h-12 rounded-xl
                        transition-all duration-300 transform font-medium
                        ${v===1?"bg-white/5 text-gray-500 cursor-not-allowed opacity-50":"bg-gradient-to-br from-cyan-500/70 via-purple-500/70 to-pink-500/70 text-white hover:from-cyan-400 hover:via-purple-400 hover:to-pink-400 hover:scale-110 hover:shadow-xl hover:shadow-purple-500/30 active:scale-95"}
                      `,"aria-label":"Previous page",children:[e.jsx(ge,{className:"w-5 h-5 rotate-180 transition-transform duration-300 group-hover:-translate-x-0.5"}),v!==1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-white/5 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/20 via-purple-500/20 to-pink-500/20 rounded-xl blur opacity-0 group-hover:opacity-60 transition-opacity duration-300 -z-10 scale-150"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:Array.from({length:M},(s,d)=>d+1).map(s=>e.jsxs("button",{onClick:()=>ke(s),className:`
                            group relative w-12 h-12 rounded-xl font-bold text-sm
                            transition-all duration-300 transform overflow-hidden
                            focus:outline-none focus:ring-2 focus:ring-purple-400/50 focus:ring-offset-2 focus:ring-offset-transparent
                            ${v===s?"bg-gradient-to-br from-cyan-500 via-purple-500 to-pink-500 text-white scale-110 shadow-xl shadow-purple-500/40 border border-white/20":"bg-white/5 text-purple-200 hover:bg-white/10 hover:text-white hover:scale-105 hover:shadow-lg hover:shadow-white/10 border border-white/10 hover:border-white/20"}
                          `,"aria-label":`Go to page ${s}`,"aria-current":v===s?"page":void 0,children:[v===s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/30 via-white/10 to-transparent animate-pulse rounded-xl"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/30 via-purple-500/30 to-pink-500/30 rounded-xl blur opacity-60 -z-10 scale-150"})]}),v!==s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/10 via-purple-500/10 to-pink-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl"}),e.jsx("div",{className:"absolute inset-0 bg-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl"})]}),e.jsx("span",{className:"relative z-10 transition-all duration-300 group-hover:scale-110",children:s})]},s))}),e.jsxs("button",{onClick:Ne,disabled:v===M,className:`
                        group relative flex items-center justify-center w-12 h-12 rounded-xl
                        transition-all duration-300 transform font-medium
                        ${v===M?"bg-white/5 text-gray-500 cursor-not-allowed opacity-50":"bg-gradient-to-br from-cyan-500/70 via-purple-500/70 to-pink-500/70 text-white hover:from-cyan-400 hover:via-purple-400 hover:to-pink-400 hover:scale-110 hover:shadow-xl hover:shadow-purple-500/30 active:scale-95"}
                      `,"aria-label":"Next page",children:[e.jsx(ge,{className:"w-5 h-5 transition-transform duration-300 group-hover:translate-x-0.5"}),v!==M&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-white/5 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/20 via-purple-500/20 to-pink-500/20 rounded-xl blur opacity-0 group-hover:opacity-60 transition-opacity duration-300 -z-10 scale-150"})]})]})]})}),e.jsx("div",{className:"bg-white/5 backdrop-blur-xl rounded-full px-5 py-2.5 border border-white/10 shadow-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-cyan-400 to-purple-400 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-purple-200 text-sm font-medium tracking-wide",children:["Medical Mission ",B+1,"-",Math.min(de,x.length)," of ",x.length]}),e.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full animate-pulse"})]})})]})]})]})})}class Ve{async getCurrentUser(){try{const a=await _().makeJsonRequest("/api/v2/auth/me");if(!a.success)throw new Error("Failed to fetch user data");return a.data}catch(a){throw console.error("Error fetching current user:",a),a}}async getDashboard(){let t=null;for(let n=1;n<=3;n++)try{console.log(`DoctorApi: Attempting to fetch dashboard data (attempt ${n}/3)`);const c=await _().makeJsonRequest("/api/v2/dashboards/dokter");if(!c.success)throw new Error("Failed to fetch dashboard data");return console.log("DoctorApi: Dashboard data fetched successfully"),c.data}catch(c){if(t=c,console.warn(`DoctorApi: Attempt ${n} failed:`,c),n<3){const o=Math.min(1e3*Math.pow(2,n-1),5e3);console.log(`DoctorApi: Retrying in ${o}ms...`),await new Promise(x=>setTimeout(x,o))}}throw console.error("DoctorApi: All attempts to fetch dashboard data failed:",t),new Error(`Failed to fetch dashboard data after 3 attempts: ${(t==null?void 0:t.message)||"Unknown error"}`)}async getJaspel(){return(await _().makeJsonRequest("/api/v2/dashboards/dokter/jaspel")).data}async getAttendanceStatus(){return(await _().makeJsonRequest("/api/v2/dashboards/dokter/attendance/status")).data}async getSchedule(){return(await _().makeJsonRequest("/api/v2/dashboards/dokter/jadwal-jaga")).data}async getCurrentSchedule(){let t=null;for(let n=1;n<=2;n++)try{console.log(`DoctorApi: Attempting to fetch current schedule (attempt ${n}/2)`);const c=await _().makeJsonRequest("/api/v2/jadwal-jaga/current");return console.log("DoctorApi: Current schedule fetched successfully"),c.data||c}catch(c){if(t=c,console.warn(`DoctorApi: Attempt ${n} failed:`,c),c&&typeof c=="object"&&"message"in c){const o=c.message;if(o.includes("404")||o.includes("No active schedule found"))return console.log("No active schedule found for today - this is normal"),{message:"No active schedule found for today",hasSchedule:!1,schedule:null,isNormalCase:!0};if(o.includes("401")||o.includes("Unauthorized"))throw new Error("Authentication required. Please login again.")}if(n<2){const o=Math.min(1e3*Math.pow(2,n-1),3e3);console.log(`DoctorApi: Retrying in ${o}ms...`),await new Promise(x=>setTimeout(x,o))}}return console.error("DoctorApi: All attempts to fetch current schedule failed:",t),{message:"Unable to fetch schedule at this time",hasSchedule:!1,schedule:null,isError:!0,error:(t==null?void 0:t.message)||"Unknown error"}}async getTodaySchedule(a){const t=a?`?date=${a}`:"";return(await _().makeJsonRequest(`/api/v2/jadwal-jaga/today${t}`)).data}async getWeeklySchedule(a){const t=a?`?week_start=${a}`:"";return(await _().makeJsonRequest(`/api/v2/jadwal-jaga/week${t}`)).data}async validateCheckin(a,t,n,c){try{const o=await _().makeJsonRequest("/api/v2/jadwal-jaga/validate-checkin",{method:"POST",body:JSON.stringify({latitude:a,longitude:t,accuracy:n||50,date:c||new Date().toISOString().split("T")[0]})});return o.data||o}catch(o){if(console.error("Error validating check-in:",o),o.message){if(o.message.includes("SHIFT_NOT_ALLOWED")||o.message.includes("shift")&&o.message.includes("allowed"))throw new Error("❌ Shift Anda tidak sesuai dengan lokasi kerja yang dikonfigurasi. Silakan hubungi administrator untuk penyesuaian jadwal.");if(o.message.includes("work_location"))throw new Error("📍 Lokasi kerja belum dikonfigurasi. Silakan hubungi administrator.");if(o.message.includes("radius")||o.message.includes("distance"))throw new Error("📏 Anda berada di luar radius lokasi kerja yang diizinkan.");if(o.message.includes("schedule"))throw new Error("📅 Jadwal kerja tidak ditemukan untuk hari ini.");if(o.message.includes("401")||o.message.includes("Unauthorized"))throw new Error("🔐 Sesi telah berakhir. Silakan login kembali.");if(o.message.includes("time")||o.message.includes("window"))throw new Error("⏰ Check-in hanya dapat dilakukan pada jam kerja yang telah ditentukan.")}throw o}}async submitGPSDebugData(a){try{const t=await _().makeJsonRequest("/api/v2/gps/debug",{method:"POST",body:JSON.stringify(a)});return t.data||t}catch(t){throw console.error("Error submitting GPS debug data:",t),t}}async getGPSDebugHistory(a=50){try{const t=await _().makeJsonRequest(`/api/v2/gps/debug/history?limit=${a}`);return t.data||t}catch(t){throw console.error("Error fetching GPS debug history:",t),t}}async validateCheckinWithDebug(a){try{const t=await _().makeJsonRequest("/api/v2/jadwal-jaga/validate-checkin-debug",{method:"POST",body:JSON.stringify(a)});return t.data||t}catch(t){if(console.error("Error validating check-in with debug:",t),t.message){if(t.message.includes("distance"))throw new Error(`Distance validation failed: ${t.message}. Current coordinates: ${a.latitude}, ${a.longitude}`);if(t.message.includes("vpn")||t.message.includes("proxy"))throw new Error("VPN/Proxy detected. Please disable VPN and try again with your actual location.");if(t.message.includes("accuracy"))throw new Error(`GPS accuracy too low (±${a.accuracy}m). Please move to an area with better GPS signal.`);if(t.message.includes("work_location"))throw new Error("Work location not configured. Please contact administrator.")}throw t}}async getWorkLocationForGPS(){try{const a=await _().makeJsonRequest("/api/v2/work-location/current");return a.data||a}catch(a){throw console.error("Error fetching work location for GPS:",a),a}}}const st=new Ve,D=class D{constructor(){U(this,"token",null);this.refreshToken()}static getInstance(){return D.instance||(D.instance=new D),D.instance}refreshToken(){const a=document.querySelector('meta[name="csrf-token"]');this.token=(a==null?void 0:a.getAttribute("content"))||null,this.token||console.warn("⚠️ CSRF token not found in meta tag")}getToken(){return this.token||this.refreshToken(),this.token||""}getHeaders(a={}){return{"X-CSRF-TOKEN":this.getToken(),"Content-Type":"application/json",Accept:"application/json",...a}}setupAxiosDefaults(){if(typeof window<"u"&&window.axios){const a=window.axios;a.defaults.headers.common["X-CSRF-TOKEN"]=this.getToken(),a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}}addTokenToForm(a){const t=a.querySelector('input[name="_token"]');if(t)t.value=this.getToken();else{const n=document.createElement("input");n.type="hidden",n.name="_token",n.value=this.getToken(),a.appendChild(n)}}interceptFetch(){const a=window.fetch;window.fetch=async(t,n)=>{const c=typeof t=="string"?t:t.toString();return(c.startsWith("/")||c.startsWith(window.location.origin))&&(n!=null&&n.method)&&["POST","PUT","PATCH","DELETE"].includes(n.method)&&(n.headers={...n.headers,"X-CSRF-TOKEN":this.getToken()}),a(t,n)}}};U(D,"instance");let ae=D;const te=ae.getInstance();document.readyState==="loading"?document.addEventListener("DOMContentLoaded",we):we();function we(){te.setupAxiosDefaults(),te.interceptFetch(),document.addEventListener("submit",h=>{const a=h.target;a.method.toUpperCase()!=="GET"&&te.addTokenToForm(a)}),console.log("✅ CSRF protection initialized")}export{Re as C,Je as F,at as J,tt as S,Fe as U,st as d};
